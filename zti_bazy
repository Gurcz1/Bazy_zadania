select imie, nazwisko, year(data_urodzenia) from pracownik;
select imie, nazwisko, '2024'-year(data_urodzenia) as wiek from pracownik;
select * from pozycja_zamowienia;
select * from kategoria;
select * from towar;
select * from pracownik;
select d.nazwa, count(d.id_dzialu) from dzial d inner join pracownik p on d.id_dzialu=p.dzial group by d.nazwa;  
select k.nazwa_kategori, sum(pz.ilosc) from kategoria k inner join towar t on t.kategoria=k.id_kategori inner join pozycja_zamowienia pz on pz.towar= t.id_towaru group by k.nazwa_kategori;
select k.nazwa_kategori,group_concat(t.nazwa_towaru) from kategoria k inner join towar t on t.kategoria=k.id_kategori group by k.nazwa_kategori;
select round(avg(pensja),2) from pracownik;
select * from pracownik where data_zatrudnienia < '2019-01-11';
select sum(pz.ilosc), t.nazwa_towaru from pozycja_zamowienia pz inner join towar t on pz.towar=t.id_towaru group by pz.towar order by sum(pz.ilosc) desc limit 10;
select * from zamowienie z inner join pozycja_zamowienia pz on pz.zamowienie=z.id_zamowienia;
select z.numer_zamowienia, sum(pz.cena*pz.cena), z.data_zamowienia from zamowienie z inner join pozycja_zamowienia pz on pz.zamowienie=z.id_zamowienia group by z.id_zamowienia
having date(z.data_zamowienia) between '2017-01-01' and '2017-03-31';

select sum(pz.cena*pz.cena) as wartosc, p.imie,p.nazwisko from zamowienie z inner join pozycja_zamowienia pz on pz.zamowienie=z.id_zamowienia
inner join pracownik p on p.id_pracownika=z.pracownik_id_pracownika group by p.id_pracownika order by wartosc desc;
